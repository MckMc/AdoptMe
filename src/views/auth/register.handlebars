<h1>Crear cuenta</h1>
<form id="f">
  <label>Nombre <input name="first_name" required></label><br>
  <label>Apellido <input name="last_name" required></label><br>
  <label>Email <input name="email" type="email" required></label><br>
  <label>Edad <input name="age" type="number" min="0" value="18"></label><br>
  <label>Contraseña <input name="password" type="password" required></label><br>
  <button type="submit">Registrarme</button>
</form>
<p id="msg"></p>
<p>¿Ya tenés cuenta? <a href="/login">Iniciar sesión</a></p>

<script>
  const f = document.getElementById('f');
  const msg = document.getElementById('msg');
  f.addEventListener('submit', async (e)=>{
    e.preventDefault();
    msg.textContent = 'Creando cuenta...';
    const form = new FormData(f);
    const body = Object.fromEntries(form.entries());
    try{
      const r = await fetch('/api/sessions/register', {
        method:'POST', headers:{'Content-Type':'application/json'},
        body: JSON.stringify(body)
      });
      const data = await r.json();
      if(!r.ok) throw new Error(data.error || 'Error');
      location.href = '/products';
    }catch(err){ msg.textContent = err.message; }
  });
</script>
